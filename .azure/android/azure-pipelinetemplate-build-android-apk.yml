# GrampsView Android Build
  
parameters:
  - name: yesNo # name of the parameter; required
    type: boolean # data type of the parameter; required
    default: false

steps:
- task: DownloadSecureFile@1
  displayName: 'Download secure file: debug.keystore'
  name: 'keystore'
  inputs:
    secureFile: 'debug.keystore'

- task: XamarinAndroid@1
  displayName: 'Build Xamarin.Android project **/*Droid*.csproj'
  inputs:
    projectFile: '**/*Droid*.csproj'
    outputDirectory: '$(OutputDirectory)'
    configuration: '$(BuildConfiguration)'
    msbuildVersionOption: latest

- task: AndroidSigning@3
  displayName: 'Signing and aligning APK file(s) $(OutputDirectory)/*.apk'
  inputs:
    apkFiles: '$(OutputDirectory)/*.apk'
    apksignerKeystoreFile: '$(keystore.secureFilePath)'
    apksignerKeystorePassword: $(KeyPassword)
    apksignerKeystoreAlias: $(KeystoreAlias)
    apksignerKeyPassword: $(KeystorePassword)

- task: CopyFiles@2
  displayName: 'Copy Files to: $(Build.ArtifactStagingDirectory)\'
  inputs:
    SourceFolder: '$(OutputDirectory)'
    TargetFolder: '$(Build.ArtifactStagingDirectory)\'


